import {GetJson as GetJson} from "loadRequested.js"
import {objectEntries as objectEntries} from "loadRequested.js"
class Concord {
	constructor() {
		let concord = document.querySelector('.bible-concord');
		let concordModal = document.querySelector('#BibleConcord');
		let bibleCover = document.querySelector('.bible-cover');
		let close = document.querySelector('.bible-close');
		let search = document.querySelector('.bible-start-search');
		let bibleInput = document.querySelector('.bible-search-concord');
		this.concord = () => concord;
		this.concordModal = () => concordModal;
		this.bibleCover = () => bibleCover;
		this.close = () => close;
		this.search = () => search;
		this.bibleInput = () => bibleInput;
	}
	showConcord() {
		this.concord().addEventListener('click', (e) => {
			this.concordModal().style["display"] = "flex";
			this.concordModal().setAttribute('data-location', 'bringdown');
			this.bibleCover().removeAttribute('data-display');

		});
		return this;
	}
	closeModal() {
		this.close().addEventListener('click', (e) => {
			this.bibleCover().setAttribute('data-display', 'none');
			this.concordModal().style["display"] = "none";
		})
		return this;
	}
	prom(inputValue, arg) {
		return new Promise((resolve, reject) => {
			try {

				//resolve(Concord.check(inputValue,splitText));
			} catch(ex) {}

		})
	}
	static check(inputValue,splitText) {

		for ( let text of splitText ) {
			console.log(text);
		}
	}
	searchConcord() {
		this.search().addEventListener('click', (e) => {

			e.preventDefault();

			if ( this.bibleInput().value.length === 0 ) {
				return false;
			}

			this.concordModal().setAttribute('data-location', 'bringup');

			setTimeout(() => {
				this.bibleCover().setAttribute('data-display', 'none');
				this.concordModal().style["display"] = "none";
				let getConcord = new GetJson("js/jsons/oldtestament.json");
				getConcord.loadJson().then((concord) => {
					let q = 0;
					for ( let [index,nameOfLocation] of objectEntries(concord) ) {

						let getLocationConcord = new GetJson(`js/jsons/${nameOfLocation}.json`);

						getLocationConcord.loadJson().then((concord) => {

							let {book, chapters} = concord

							for ( let [index,versesValue] of objectEntries(chapters) ) {

								let {chapter,verses} = versesValue;

								let text = 1;
								let userInput = this.bibleInput().value;
								let userInpuRegex = new RegExp(userInput, "igm")

								Array.from(verses, (v) => {

										if ( userInpuRegex.test(v[text]) ) {
											console.log(v[text]);
										}
										text = 1 + text
								})
							}
						})
					}
				})
			}, 50);

		})
	}
}

var q = new Concord();

q.showConcord().closeModal().searchConcord();
